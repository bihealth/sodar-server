{% load rules %}
{% load samplesheets_tags %}
{% load projectroles_common_tags %}

{% check_backend 'omics_irods' as irods_backend_enabled %}

{% if irods_backend_enabled %}
  {% load irodsbackend_tags %}
  {% get_webdav_url as webdav_url %}
{% endif %}

<tr class="omics-ss-search-list-item" id="omics-ss-project-search-item-{{ item.omics_uuid }}">
  <td class="text-nowrap">
    {% highlight_search_term item.name search_term as item_display_name %}
    {% if item.type != 'file' %}
      <a href="{% url 'samplesheets:project_sheets' study=item.study.omics_uuid %}">{{ item_display_name |safe }}</a>
    {% else %}
      {% if webdav_url %}
        <a href="{{ webdav_url }}{{ item.irods_path }}">{{ item_display_name | safe }}</a>
      {% else %}
        {{ item.name }}
      {% endif %}
    {% endif %}
  </td>
  <td class="text-nowrap">
    {% get_search_item_type item %}
  </td>
  <td>
    {% autoescape off %}
      {% get_project_link item.project %}
    {% endautoescape %}
  </td>
  <td>
    {% if item.study %}
      <a href="{% url 'samplesheets:project_sheets' study=item.study.omics_uuid %}">
        {{ item.study.get_display_name }}
      </a>
    {% else %}
      N/A
    {% endif %}
  </td>
  <td>
    {% if item.assays %}
      {% for assay in item.assays %}
        <a href="{% url 'samplesheets:project_sheets' study=item.study.omics_uuid %}#assay{{ assay.omics_uuid }}">
          {{ assay.get_display_name }}
        </a>
        <br />
      {% endfor %}
    {% else %}
      N/A
    {% endif %}
  </td>
</tr>
