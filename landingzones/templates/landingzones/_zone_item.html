{% load landingzones_tags %}

{# Projectroles dependency #}
{% load projectroles_common_tags %}

{# Load irodsbackend tags if backend is active #}
{% if irods_backend %}
  {% load irodsbackend_tags %}
{% endif %}

{% is_zone_enabled zone as zone_enabled %}

<tr class="{% get_zone_row_class zone %}"
    id="{{ zone.omics_uuid }}"
    zone-uuid="{{ zone.omics_uuid }}"
    sample-url="{% get_zone_samples_url zone %}"
    status-url="{% url 'landingzones:status' landingzone=zone.omics_uuid %}"
    file-stats-url="{% url 'landingzones:statistics' landingzone=zone.omics_uuid %}">
  <td class="omics-lz-zone-title">
    {% if zone.user != request.user %}
      {% autoescape off %}
        {% get_user_html zone.user %} /
      {% endautoescape %}
    {% endif %}
      {% if details_card_mode %}
        <a href="{% url 'landingzones:list' project=project.omics_uuid %}#{{ zone.omics_uuid }}">
      {% endif %}
      {{ zone.title|force_wrap:16|safe }}
      {% if details_card_mode %}
        </a>
      {% endif %}
      {% if zone.description %}
        <a class="omics-ss-assay-info-link" tabindex="0" data-toggle="popover"
           data-trigger="focus" data-placement="top" data-html="true"
           data-content="{% get_zone_desc_html zone %}">
          <i class="fa fa-info-circle text-info"></i>
        </a>
    {% endif %}
    {% if zone.configuration %}
      <span class="badge badge-pill badge-success">{% get_config_legend zone %}</span>
    {% endif %}
  </td>

  <td class="omics-lz-zone-assay">{{ zone.assay.get_display_name }}</td>
  <td class="omics-lz-zone-status-info">
      <span id="omics-lz-zone-status-info-{{ zone.omics_uuid }}">
        {{ zone.status_info }}
      </span>
      <span id="omics-lz-zone-status-moved-{{ zone.omics_uuid }}">
      {% if zone.status == 'MOVED' %}
        <p class="mb-0">
          <a href="{% get_zone_samples_url zone %}"><i class="fa fa-arrow-circle-right"></i> Browse files in sample sheets</a>
        </p>
      </span>
      {% endif %}
      {% if zone_enabled and irods_backend %}
        <p class="mb-0" id="omics-lz-zone-stats-container-{{ zone.omics_uuid }}">
          {% get_irods_path zone as zone_irods_path %}
          {% autoescape off %}
            {% get_stats_html zone_irods_path project %}
          {% endautoescape %}
          {% comment %}
          <span class="badge badge-pill badge-info" id="omics-lz-zone-stats-{{ zone.omics_uuid }}"><i class="fa fa-spin fa-circle-o-notch"></i> Updating stats..</span>
          {% endcomment %}
        </p>
      {% endif %}
  </td>
  <td id="omics-lz-zone-status-{{ zone.omics_uuid }}"
      class="omics-lz-zone-status text-white {% get_status_style zone %}">
    {{ zone.status }}
  </td>
  {% if not details_card_mode %}
    <td class="omics-lz-zone-links">
      <span class="omics-lz-control">
        {% get_irods_path zone as zone_irods_path %}
        {% get_zone_list_url zone as zone_list_url %}
        {% is_zone_disabled zone as disable_all %}
        {% include 'samplesheets/_irods_buttons.html' with investigation=zone.assay.study.investigation irods_path=zone_irods_path list_url=zone_list_url data_table=False show_file_list=True disable_all=disable_all%}
      </span>
    </td>
    <td class="omics-lz-zone-edit">
      <span class="omics-lz-control">
        {% include 'landingzones/_zone_buttons.html' %}
      </span>
    </td>
  {% endif %}
</tr>
