{% load filesfolders_tags %}

<tr>
  {# Icon & name column #}
  <td>
    {% if item|get_class == 'Folder' %}
      <i class="fa fa-folder"></i>
    {% elif item|get_class == 'HyperLink' %}
      <i class="fa fa-external-link"></i>
    {% elif item|get_class == 'File' %}
      {# TODO: this is ugly, get from settings instead? #}
      {% if file.content_type == 'application/pdf' %}
        <i class="fa fa-file-pdf-o"></i>
      {% elif file.content_type == 'application/vnd.openxmlformats-officedocument.presentationml.presentation' %}
        <i class="fa fa-file-powerpoint-o"></i>
      {% elif 'compressed' in file.content_type or 'zip' in file.content_type %}
        <i class="fa fa-file-archive-o"></i>
      {% elif 'excel' in file.content_type or file.content_type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' %}
        <i class="fa fa-file-excel-o"></i>
      {% elif 'image/' in file.content_type %}
        <i class="fa fa-file-image-o"></i>
      {% elif 'text/' in file.content_type %}
        <i class="fa fa-file-text-o"></i>
      {% else %}
        <i class="fa fa-file-o"></i>
      {% endif %}
    {% endif %}
  </td>
  {# Name/link column #}
  <td>
    {% if item|get_class == 'Folder' %}
      <a href="{% url 'project_files' project=project.pk folder=item.id %}">{% autoescape off %}{{ item.name|force_wrap:24 }}{% endautoescape %}</a>
    {% elif item|get_class == 'HyperLink' %}
      <a href="{{ item.url }}" target="_blank">{% autoescape off %}{{ item.name|force_wrap:24 }}{% endautoescape %}</a>
    {% elif item|get_class == 'File' %}
      <a href="{% url 'file_serve' pk=item.pk project=object.pk file_name=item.name %}">{% autoescape off %}{{ item.name|force_wrap:24 }}{% endautoescape %}</a>
      {% if allow_public_links and item.public_url and can_share_link %}
        <a title="Public Link" href="{% url 'file_public_link' pk=item.pk project=item.project.pk %}" id="ff_link_public_{{ item.pk }}">
          <i class="fa fa-link" aria-hidden="false"></i>
        </a>
      {% endif %}
    {% endif %}
  </td>
  {# File size column (only for files) #}
  <td class="text-right">
    {% if item|get_class == 'File' %}
      {{ item.file.file.size|filesizeformat }}
    {% endif %}
  </td>
  {# Description column #}
  <td>{{ item.description }}</td>
  {# Owner column #}
  <td><a title="{{ item.owner.name }}" href="mailto:{{ item.owner.email }}">{{ item.owner.username }}</a></td>
  {# Date column #}
  <td>{{ item.date_modified|date:'Y-m-d H:i' }}</td>

  {% if not details_card_mode %}
  {# Action button column #}
    <td class="ff_action_column">
      {% if can_update_all or item.owner == request.user and can_update_own %}
        {% if item|get_class == 'Folder' %}
          {% include 'filesfolders/_folder_buttons.html' with pk=item.pk %}
        {% elif item|get_class == 'HyperLink' %}
          {% include 'filesfolders/_hyperlink_buttons.html' with link=item %}
        {% elif item|get_class == 'File' %}
          {% include 'filesfolders/_file_buttons.html' with file=file %}
        {% endif %}
      {% endif %}
    </td>
    {# Checkbox column #}
    <td>
      {% if can_update_all or item.owner == request.user and can_update_own %}
        <input class="form-check-input" type="checkbox" id="ff_file_checkbox_{{ item.pk }}" name="batch_item_{{ item|get_class }}_{{ item.pk }}" value="1" />
      {% endif %}
    </td>
  {% endif %}
</tr>
